!function(){"use strict";var e=document.querySelector(".profile__edit-button"),t=document.querySelector(".profile__add-button"),r=document.querySelector(".popup__form_type_edit"),n=document.querySelector(".popup__form_type_add-image"),o=document.querySelector(".popup__form_type_profile-image"),i=document.querySelector(".profile__user"),u=document.querySelector(".profile__profession"),a=document.querySelector(".profile__image"),c=document.querySelector(".popup__button_type_delete"),l=document.querySelector(".popup__button_type_edit"),s=document.querySelector(".popup__button_type_profile-image"),f=document.querySelector(".profile__avatar-overlay"),p=document.querySelector(".popup__create-card-button"),y={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==d(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===d(o)?o:String(o)),n)}var o}var m=function(){function e(t,r){var n=t.data,o=t.handleCardClick,i=t.handleDeleteClick,u=t.handleLikeAdd,a=t.handleLikeDelete,c=t.userId;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=n.name,this._link=n.link,this._template=r,this._id=n._id,this._likesCount=n.likes.length,this._ownerId=n.owner._id,this._user=c,this._handleCardClick=o,this._handleDeleteClick=i,this._handleLikeAdd=u,this._handleLikeDelete=a,this._likesArray=n.likes,this._cardLikes=n.likes.length}var t,r;return t=e,(r=[{key:"_getTemplate",value:function(){return document.querySelector(this._template).content.querySelector(".card").cloneNode(!0)}},{key:"addHeart",value:function(){var e=this._element.querySelector(".card__like-button"),t=this._element.querySelector(".card__like-counter");e.classList.add("card__like-button_on"),t.textContent=this._likesArray.length}},{key:"removeHeart",value:function(){var e=this._element.querySelector(".card__like-button"),t=this._element.querySelector(".card__like-counter");e.classList.remove("card__like-button_on"),t.textContent=this._likesArray.length,0===this._cardLikes&&(t.textContent="")}},{key:"_deleteButton",value:function(){this._element.querySelector(".card__delete-button").closest(".card").remove()}},{key:"updateLikes",value:function(e){return this._likesArray=e}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".card__like-button").addEventListener("click",(function(){e._likesArray.some((function(t){return t._id===e._user}))?e._handleLikeDelete({id:e._id}):e._handleLikeAdd({id:e._id})})),this._element.querySelector(".card__delete-button").addEventListener("click",(function(){e._handleDeleteClick({id:e._id})})),this._element.querySelector(".card__image").addEventListener("click",(function(){return e._handleCardClick({name:e._name,link:e._link})})),this._ownerId!==this._user&&this._element.querySelector(".card__delete-button").remove()}},{key:"generateCard",value:function(){var e=this;this._element=this._getTemplate(),this._setEventListeners();var t=this._element.querySelector(".card__image");return this._element.querySelector(".card__title").textContent=this._name,t.src=this._link,t.setAttribute("alt",this._name),this._cardLikes>0?this._element.querySelector(".card__like-counter").textContent=this._cardLikes:this._element.querySelector(".card__like-counter").textContent="",this._likesArray.some((function(t){return t._id===e._user}))?this._element.querySelector(".card__like-button").classList.add("card__like-button_on"):this._element.querySelector(".card__like-button").classList.remove("card__like-button_on"),this._element}}])&&h(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function b(e,t,r){return(t=S(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S(e){var t=function(e,t){if("object"!==_(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==_(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===_(t)?t:String(t)}var k=function(){function e(t,r){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),b(this,"_setEventListeners",(function(){n._inputList.forEach((function(e){e.addEventListener("input",(function(){n._checkInputValidity(e),n._toggleButtonState()}))}))})),b(this,"enableValidation",(function(){n._formElement.addEventListener("submit",(function(e){e.preventDefault()})),n._setEventListeners()})),this._formElement=t,this._inputSelector=r.inputSelector,this._submitButtonSelector=r.submitButtonSelector,this._inactiveButtonClass=r.inactiveButtonClass,this._inputErrorClass=r.inputErrorClass,this._errorClass=r.errorClass,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._buttonElement=this._formElement.querySelector(this._submitButtonSelector)}var t,r;return t=e,(r=[{key:"_showInputError",value:function(e,t){var r=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.add(this._inputErrorClass),r.classList.add(this._errorClass),r.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"_toggleButtonState",value:function(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}},{key:"resetValidation",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){e._hideInputError(t),t.value=""}))}}])&&v(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function E(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==g(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==g(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===g(o)?o:String(o)),n)}var o}var w=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popupElement=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,r;return t=e,(r=[{key:"open",value:function(){this._popupElement.classList.add("popup_opened"),document.addEventListener("keyup",this._handleEscClose)}},{key:"close",value:function(){this._popupElement.classList.remove("popup_opened"),document.removeEventListener("keyup",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(){var e=this;this._popupElement.addEventListener("click",(function(t){t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close-button")?e.close():t.target.closest(".popup")||e.close()}))}}])&&E(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function L(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==O(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==O(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===O(o)?o:String(o)),n)}var o}function j(){return j="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=P(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},j.apply(this,arguments)}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(u,e);var t,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(n);if(o){var r=P(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t,r=e.popupSelector,n=e.handleFormSubmit,o=e.submitButton;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,r))._handleFormSubmit=n,t._inputList=t._popupElement.querySelectorAll(".popup__input"),t._formElement=t._popupElement.querySelector(".popup__form"),t._submitButton=o,t}return t=u,(r=[{key:"close",value:function(){j(P(u.prototype),"close",this).call(this),this.renderLoading(!1),this._formElement.reset()}},{key:"_getInputValues",value:function(){var e=this;return this._formValues={},this._inputList.forEach((function(t){e._formValues[t.name]=t.value})),this._formValues}},{key:"renderLoading",value:function(e){this._submitButton.textContent=e?"Guardando...":this._submitButton.dataset.textcontent}},{key:"setEventListeners",value:function(){var e=this;j(P(u.prototype),"setEventListeners",this).call(this),this._formElement.addEventListener("submit",(function(t){t.preventDefault(),e.renderLoading(!0),e._handleFormSubmit(e._getInputValues())}))}}])&&L(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(w);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function T(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==R(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===R(o)?o:String(o)),n)}var o}function B(){return B="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},B.apply(this,arguments)}function I(e,t){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},I(e,t)}function A(e){return A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},A(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&I(e,t)}(u,e);var t,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=A(n);if(o){var r=A(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t,r=e.popupSelector,n=e.handleFormSubmit,o=e.submitButton;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,r))._handleFormSubmit=n,t._submitButton=o,t}return t=u,(r=[{key:"close",value:function(){B(A(u.prototype),"close",this).call(this),this.renderLoading(!1)}},{key:"setSubmitAction",value:function(e){this._handleFormSubmit=e}},{key:"renderLoading",value:function(e){this._submitButton.textContent=e?"Borrando...":this._submitButton.dataset.textcontent}},{key:"setEventListeners",value:function(){var e=this;B(A(u.prototype),"setEventListeners",this).call(this),this._popupElement.querySelector(".popup__button").addEventListener("click",(function(t){t.preventDefault(),e.renderLoading(!0),e._handleFormSubmit()}))}}])&&T(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(w);function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==x(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==x(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===x(o)?o:String(o)),n)}var o}function V(){return V="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=N(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},V.apply(this,arguments)}function F(e,t){return F=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},F(e,t)}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}var H=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&F(e,t)}(u,e);var t,r,n,o,i=(n=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=N(n);if(o){var r=N(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return function(e,t){if(t&&("object"===x(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._image=t._popupElement.querySelector(".popup__image"),t._title=t._popupElement.querySelector(".popup__caption"),t}return t=u,(r=[{key:"open",value:function(e){var t=e.link,r=e.name;this._image.src=t,this._title.textContent=r,this._image.setAttribute("alt",r),V(N(u.prototype),"open",this).call(this)}}])&&D(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),u}(w);function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function J(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==G(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==G(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===G(o)?o:String(o)),n)}var o}var z=function(){function e(t,r){var n=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=n,this._renderer=o,this._container=document.querySelector(r)}var t,r;return t=e,(r=[{key:"renderer",value:function(){var e=this;this._renderedItems.forEach((function(t){e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}},{key:"addCards",value:function(e){this._container.append(e)}}])&&J(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function M(e){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M(e)}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==M(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===M(o)?o:String(o)),n)}var o}var Q=function(){function e(t){var r=t.userName,n=t.userOcupation,o=t.userAvatar,i=t.userId;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._userName=r,this._userOcupation=n,this._userId=i,this._userAvatar=o}var t,r;return t=e,(r=[{key:"getUserInfo",value:function(){return{userName:this._userName.textContent,userOcupation:this._userOcupation.textContent}}},{key:"setUserInfo",value:function(e){var t=e.username,r=e.userocupation;this._userName.textContent=t,this._userOcupation.textContent=r}},{key:"setUserAvatar",value:function(e){this._userAvatar.src=e}}])&&K(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function W(e){return W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},W(e)}function X(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==W(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,"string");if("object"!==W(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(n.key),"symbol"===W(o)?o:String(o)),n)}var o}var Y=new(function(){function e(t){var r=t.baseUrl,n=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=r,this._headers=n}var t,r;return t=e,(r=[{key:"_returnRes",value:function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}},{key:"getCardList",value:function(){var e=this;return fetch(this._baseUrl+"/cards",{method:"GET",headers:this._headers}).then((function(t){return e._returnRes(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseUrl+"/users/me",{method:"GET",headers:this._headers}).then((function(t){return e._returnRes(t)}))}},{key:"setUserInfo",value:function(e){var t=this,r=e.name,n=e.about;return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:this._headers,body:JSON.stringify({name:r,about:n})}).then((function(e){return t._returnRes(e)})).catch((function(e){return console.log(e)}))}},{key:"addCard",value:function(e){var t=this,r=e.name,n=e.link;return fetch(this._baseUrl+"/cards",{method:"POST",headers:this._headers,body:JSON.stringify({name:r,link:n})}).then((function(e){return t._returnRes(e)}))}},{key:"removeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:this._headers}).then((function(e){return t._returnRes(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return t._returnRes(e)}))}},{key:"addLike",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._headers}).then((function(e){return t._returnRes(e)}))}},{key:"removeLike",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._headers}).then((function(e){return t._returnRes(e)}))}}])&&X(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}())({baseUrl:"https://around.nomoreparties.co/v1/web_es_cohort_04",headers:{authorization:"c3631954-8031-4a1f-b1bb-1315bd763fc8","Content-Type":"application/json"}}),Z=new k(r,y),$=new k(n,y),ee=new k(o,y);Z.enableValidation(),$.enableValidation(),ee.enableValidation();var te=new H(".popup_preview_image");te.setEventListeners();var re=new q({popupSelector:".popup_edit_profile",handleFormSubmit:function(e){Y.setUserInfo({name:e.name,about:e.about}).then((function(e){ne.setUserInfo({username:e.name,userocupation:e.about}),re.close()})).catch((function(e){return console.log(e)}))},submitButton:l});re.setEventListeners();var ne=new Q({userName:i,userOcupation:u,userAvatar:a});e.addEventListener("click",(function(){re.open(),Z.resetValidation()})),Y.getUserInfo().then((function(e){ne.setUserInfo({username:e.name,userocupation:e.about}),ne.setUserAvatar(e.avatar),ne.userId=e._id})).then((function(){Y.getCardList().then((function(e){var r=new z({items:e,renderer:function(e){var t=ue(e);r.addCards(t)}},".cards__container");r.renderer();var n=new q({popupSelector:".popup_add_card",handleFormSubmit:function(e){Y.addCard({name:e.title,link:e["image-link"]}).then((function(e){var t=ue(e);r.addItem(t),n.close()})).catch((function(e){return console.log(e)}))},submitButton:p});n.setEventListeners(),t.addEventListener("click",(function(){n.open(),$.resetValidation()}))})).catch((function(e){return console.log(e)}))})).catch((function(e){return console.log(e)}));var oe=new q({popupSelector:".popup_image_profile",handleFormSubmit:function(e){var t=e["image-link"];Y.setUserAvatar(t).then((function(){ne.setUserAvatar(t),oe.close()})).catch((function(e){return console.log(e)}))},submitButton:s});oe.setEventListeners(),f.addEventListener("click",(function(){oe.open(),ee.resetValidation()}));var ie=new U({popupSelector:".popup_delete_card",submitButton:c});function ue(e){var t=new m({data:e,handleCardClick:function(e){var t=e.name,r=e.link;te.open({name:t,link:r})},handleDeleteClick:function(e){var r=e.id;ie.open(),ie.setSubmitAction((function(){Y.removeCard(r).then((function(){ie.close(),t._deleteButton()})).catch((function(e){return console.log(e)}))}))},handleLikeAdd:function(e){var r=e.id;Y.addLike(r).then((function(e){t.updateLikes(e.likes),t.addHeart()})).catch((function(e){return console.log(e)}))},handleLikeDelete:function(e){var r=e.id;Y.removeLike(r).then((function(e){t.updateLikes(e.likes),t.removeHeart()})).catch((function(e){return console.log(e)}))},userId:ne.userId},".card-template");return t.generateCard()}ie.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QSxHQUNmcUYsRUFDR3VELFFBQVE1SSxHQUNSa0csTUFBSyxTQUFDUixHQUNMOEMsRUFBUUssWUFBWW5ELEVBQUluSCxPQUN4QmlLLEVBQVFNLFVBQ1YsSUFDQ3RDLE9BQU0sU0FBQ0MsR0FBRyxPQUFLQyxRQUFRQyxJQUFJRixFQUFJLEdBQ3BDLEVBQ0E1SSxpQkFBa0IsWUFBVSxJQUFSbUMsRUFBRSxFQUFGQSxHQUNsQnFGLEVBQ0cwRCxXQUFXL0ksR0FDWGtHLE1BQUssU0FBQ1IsR0FDTDhDLEVBQVFLLFlBQVluRCxFQUFJbkgsT0FDeEJpSyxFQUFRUSxhQUNWLElBQ0N4QyxPQUFNLFNBQUNDLEdBQUcsT0FBS0MsUUFBUUMsSUFBSUYsRUFBSSxHQUNwQyxFQUNBM0ksT0FBUXlKLEdBQVl6SixRQUV0QixrQkFFRixPQUFPMEssRUFBUVMsY0FDakIsQ0E1Q0FWLEdBQWdCcEIsbUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9zY3JpcHRzL3V0aWxzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9zY3JpcHRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvc2NyaXB0cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80X2VzcC8uL3NyYy9zY3JpcHRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvc2NyaXB0cy9Qb3B1cERlbGV0ZUltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvc2NyaXB0cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzRfZXNwLy4vc3JjL3NjcmlwdHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNF9lc3AvLi9zcmMvc2NyaXB0cy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVmFyaWFibGVzXHJcblxyXG5leHBvcnQgY29uc3Qgb3BlbkZvcm1Qcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XHJcblxyXG5leHBvcnQgY29uc3Qgb3BlbkNhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1FZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19mb3JtX3R5cGVfZWRpdCcpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1JbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fZm9ybV90eXBlX2FkZC1pbWFnZScpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1Qcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm1fdHlwZV9wcm9maWxlLWltYWdlJyk7XHJcblxyXG4vL2V4cG9ydCBjb25zdCBpbnB1dE5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfbmFtZScpO1xyXG5cclxuLy9leHBvcnQgY29uc3QgaW5wdXRPY3VwYXRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2lucHV0X3R5cGVfYWJvdXQnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fdXNlcicpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVQcm9mZXNzaW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3Byb2Zlc3Npb24nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9faW1hZ2UnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBkZWxldGVDYXJkU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19idXR0b25fdHlwZV9kZWxldGUnKTtcclxuXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZVN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uX3R5cGVfZWRpdCcpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVJbWFnZVN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fYnV0dG9uX3R5cGVfcHJvZmlsZS1pbWFnZScpO1xyXG5cclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVJbWFnZU92ZXJsYXkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYXZhdGFyLW92ZXJsYXknKTtcclxuXHJcbmV4cG9ydCBjb25zdCBhZGRDYXJkU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jcmVhdGUtY2FyZC1idXR0b24nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXHJcbiAge1xyXG4gICAgbmFtZTogJ1ZhbGxlIGRlIFlvc2VtaXRlJyxcclxuICAgIGxpbms6ICdodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS95b3NlbWl0ZS5qcGcnLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ0xhZ28gTG91aXNlJyxcclxuICAgIGxpbms6ICdodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS9sYWtlLWxvdWlzZS5qcGcnLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ01vbnRhw7FhcyBDYWx2YXMnLFxyXG4gICAgbGluazogJ2h0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2JhbGQtbW91bnRhaW5zLmpwZycsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiAnTGF0ZW1hcicsXHJcbiAgICBsaW5rOiAnaHR0cHM6Ly9jb2RlLnMzLnlhbmRleC5uZXQvd2ViLWNvZGUvbGF0ZW1hci5qcGcnLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogJ1BhcnF1ZSBOYWNpb25hbCBkZSBsYSBWYW5vaXNlJyxcclxuICAgIGxpbms6ICdodHRwczovL2NvZGUuczMueWFuZGV4Lm5ldC93ZWItY29kZS92YW5vaXNlLmpwZycsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiAnTGFnbyBkaSBCcmFpZXMnLFxyXG4gICAgbGluazogJ2h0dHBzOi8vY29kZS5zMy55YW5kZXgubmV0L3dlYi1jb2RlL2xhZ28uanBnJyxcclxuICB9LFxyXG5dO1xyXG5cclxuZXhwb3J0IGNvbnN0IHNlbGVjdG9ycyA9IHtcclxuICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxyXG4gIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2lucHV0JyxcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fYnV0dG9uJyxcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX2J1dHRvbl9kaXNhYmxlZCcsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2lucHV0X3R5cGVfZXJyb3InLFxyXG4gIGVycm9yQ2xhc3M6ICdwb3B1cF9fZXJyb3JfdmlzaWJsZScsXHJcbn07XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAge2RhdGEsIGhhbmRsZUNhcmRDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2ssIGhhbmRsZUxpa2VBZGQsIGhhbmRsZUxpa2VEZWxldGUsIHVzZXJJZH0sXHJcbiAgICB0ZW1wbGF0ZVxyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xyXG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcclxuICAgIHRoaXMuX2xpa2VzQ291bnQgPSBkYXRhLmxpa2VzLmxlbmd0aDtcclxuICAgIHRoaXMuX293bmVySWQgPSBkYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX3VzZXIgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUFkZCA9IGhhbmRsZUxpa2VBZGQ7XHJcbiAgICB0aGlzLl9oYW5kbGVMaWtlRGVsZXRlID0gaGFuZGxlTGlrZURlbGV0ZTtcclxuICAgIHRoaXMuX2xpa2VzQXJyYXkgPSBkYXRhLmxpa2VzO1xyXG4gICAgdGhpcy5fY2FyZExpa2VzID0gZGF0YS5saWtlcy5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX3RlbXBsYXRlKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZCcpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbiAgfVxyXG5cclxuICBhZGRIZWFydCgpIHtcclxuICAgIGNvbnN0IGhlYXJ0QnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICAgIGNvbnN0IGhlYXJ0TnVtYmVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudGVyJyk7XHJcblxyXG4gICAgaGVhcnRCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idXR0b25fb24nKTtcclxuICAgIGhlYXJ0TnVtYmVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNBcnJheS5sZW5ndGg7XHJcbiAgfVxyXG5cclxuICByZW1vdmVIZWFydCgpIHtcclxuICAgIGNvbnN0IGhlYXJ0QnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICAgIGNvbnN0IGhlYXJ0TnVtYmVyID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudGVyJyk7XHJcblxyXG4gICAgaGVhcnRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idXR0b25fb24nKTtcclxuICAgIGhlYXJ0TnVtYmVyLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXNBcnJheS5sZW5ndGg7XHJcbiAgICBpZiAodGhpcy5fY2FyZExpa2VzID09PSAwKSB7XHJcbiAgICAgIGhlYXJ0TnVtYmVyLnRleHRDb250ZW50ID0gJyc7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZGVsZXRlQnV0dG9uKCkge1xyXG4gICAgY29uc3QgdHJhc2hCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19kZWxldGUtYnV0dG9uJyk7XHJcbiAgICB0cmFzaEJ1dHRvbi5jbG9zZXN0KCcuY2FyZCcpLnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXMocmVzQXJyYXkpIHtcclxuICAgIHJldHVybiAodGhpcy5fbGlrZXNBcnJheSA9IHJlc0FycmF5KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2xpa2UtYnV0dG9uJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICB0aGlzLl9saWtlc0FycmF5LnNvbWUoKGxpa2UpID0+IHtcclxuICAgICAgICAgIHJldHVybiBsaWtlLl9pZCA9PT0gdGhpcy5fdXNlcjtcclxuICAgICAgICB9KVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlRGVsZXRlKHtcclxuICAgICAgICAgIGlkOiB0aGlzLl9pZCxcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQWRkKHtcclxuICAgICAgICAgIGlkOiB0aGlzLl9pZCxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh7XHJcbiAgICAgICAgaWQ6IHRoaXMuX2lkLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PlxyXG4gICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soe1xyXG4gICAgICAgIG5hbWU6IHRoaXMuX25hbWUsXHJcbiAgICAgICAgbGluazogdGhpcy5fbGluayxcclxuICAgICAgfSlcclxuICAgICk7XHJcblxyXG4gICAgaWYgKHRoaXMuX293bmVySWQgIT09IHRoaXMuX3VzZXIpIHtcclxuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fZGVsZXRlLWJ1dHRvbicpLnJlbW92ZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIGNvbnN0IGNhcmRJbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmNhcmRfX2ltYWdlJyk7XHJcbiAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIGNhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgY2FyZEltYWdlLnNldEF0dHJpYnV0ZSgnYWx0JywgdGhpcy5fbmFtZSk7XHJcblxyXG4gICAgaWYgKHRoaXMuX2NhcmRMaWtlcyA+IDApIHtcclxuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1jb3VudGVyJykudGV4dENvbnRlbnQgPSB0aGlzLl9jYXJkTGlrZXM7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jYXJkX19saWtlLWNvdW50ZXInKS50ZXh0Q29udGVudCA9ICcnO1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChcclxuICAgICAgdGhpcy5fbGlrZXNBcnJheS5zb21lKChsaWtlKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGxpa2UuX2lkID09PSB0aGlzLl91c2VyO1xyXG4gICAgICB9KVxyXG4gICAgKSB7XHJcbiAgICAgIGNvbnN0IGhlYXJ0QnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICAgICAgaGVhcnRCdXR0b24uY2xhc3NMaXN0LmFkZCgnY2FyZF9fbGlrZS1idXR0b25fb24nKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnN0IGhlYXJ0QnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuY2FyZF9fbGlrZS1idXR0b24nKTtcclxuICAgICAgaGVhcnRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnY2FyZF9fbGlrZS1idXR0b25fb24nKTtcclxuICAgIH1cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcihmb3JtRWxlbWVudCwgc2VsZWN0b3JzKSB7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNlbGVjdG9ycy5pbnB1dFNlbGVjdG9yO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBzZWxlY3RvcnMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2VsZWN0b3JzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBzZWxlY3RvcnMuaW5wdXRFcnJvckNsYXNzO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHNlbGVjdG9ycy5lcnJvckNsYXNzO1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gIH1cclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gJyc7XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0KSB7XHJcbiAgICBpZiAoIWlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0LCBpbnB1dC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xyXG4gICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dCk7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gJyc7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycyA9ICgpID0+IHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbiA9ICgpID0+IHtcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfTtcclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXl1cCcsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XHJcbiAgICBpZiAoZXZ0LmtleSA9PT0gJ0VzY2FwZScpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfX2Nsb3NlLWJ1dHRvbicpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfSBlbHNlIGlmICghZXZ0LnRhcmdldC5jbG9zZXN0KCcucG9wdXAnKSkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7cG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCwgc3VibWl0QnV0dG9ufSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2lucHV0Jyk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Zvcm0nKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHN1Ym1pdEJ1dHRvbjtcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIHRoaXMucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSAnR3VhcmRhbmRvLi4uJztcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi5kYXRhc2V0LnRleHRjb250ZW50O1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwRGVsZXRlSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3Ioe3BvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQsIHN1Ym1pdEJ1dHRvbn0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSBzdWJtaXRCdXR0b247XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB0aGlzLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcclxuICB9XHJcblxyXG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9ICdCb3JyYW5kby4uLic7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b24uZGF0YXNldC50ZXh0Y29udGVudDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2J1dHRvbicpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XHJcbiAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcclxuICB9XHJcblxyXG4gIG9wZW4oe2xpbmssIG5hbWV9KSB7XHJcbiAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5faW1hZ2Uuc2V0QXR0cmlidXRlKCdhbHQnLCBuYW1lKTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuXHJcblxyXG5cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3Ioe2l0ZW1zLCByZW5kZXJlcn0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG4gIHJlbmRlcmVyKCkge1xyXG4gICAgdGhpcy5fcmVuZGVyZWRJdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkcyhlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3Ioe3VzZXJOYW1lLCB1c2VyT2N1cGF0aW9uLCB1c2VyQXZhdGFyLCB1c2VySWR9KSB7XHJcbiAgICB0aGlzLl91c2VyTmFtZSA9IHVzZXJOYW1lO1xyXG4gICAgdGhpcy5fdXNlck9jdXBhdGlvbiA9IHVzZXJPY3VwYXRpb247XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl91c2VyQXZhdGFyID0gdXNlckF2YXRhcjtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgdXNlck5hbWU6IHRoaXMuX3VzZXJOYW1lLnRleHRDb250ZW50LFxyXG4gICAgICB1c2VyT2N1cGF0aW9uOiB0aGlzLl91c2VyT2N1cGF0aW9uLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKGRhdGEpIHtcclxuICAgIGNvbnN0IHt1c2VybmFtZSwgdXNlcm9jdXBhdGlvbn0gPSBkYXRhO1xyXG4gICAgdGhpcy5fdXNlck5hbWUudGV4dENvbnRlbnQgPSB1c2VybmFtZTtcclxuICAgIHRoaXMuX3VzZXJPY3VwYXRpb24udGV4dENvbnRlbnQgPSB1c2Vyb2N1cGF0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHRoaXMuX3VzZXJBdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgJy4vcGFnZXMvaW5kZXguY3NzJztcclxuaW1wb3J0IHtcclxuICBzZWxlY3RvcnMsXHJcbiAgb3BlbkZvcm1Qcm9maWxlLFxyXG4vLyAgaW5wdXROYW1lLFxyXG4vLyAgaW5wdXRPY3VwYXRpb24sXHJcbiAgZm9ybUVkaXQsXHJcbiAgZm9ybUltYWdlLFxyXG4gIGZvcm1Qcm9maWxlSW1hZ2UsXHJcbiAgcHJvZmlsZVRpdGxlLFxyXG4gIHByb2ZpbGVQcm9mZXNzaW9uLFxyXG4gIHByb2ZpbGVJbWFnZSxcclxuICBvcGVuQ2FyZEJ1dHRvbixcclxuICBhZGRDYXJkU3VibWl0QnV0dG9uLFxyXG4gIGRlbGV0ZUNhcmRTdWJtaXRCdXR0b24sXHJcbiAgZWRpdFByb2ZpbGVTdWJtaXRCdXR0b24sXHJcbiAgcHJvZmlsZUltYWdlU3VibWl0QnV0dG9uLFxyXG4gIHByb2ZpbGVJbWFnZU92ZXJsYXksXHJcbn0gZnJvbSAnLi9zY3JpcHRzL3V0aWxzLmpzJztcclxuaW1wb3J0IENhcmQgZnJvbSAnLi9zY3JpcHRzL0NhcmQuanMnO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tICcuL3NjcmlwdHMvRm9ybVZhbGlkYXRvci5qcyc7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gJy4vc2NyaXB0cy9Qb3B1cFdpdGhGb3JtLmpzJztcclxuaW1wb3J0IFBvcHVwRGVsZXRlSW1hZ2UgZnJvbSAnLi9zY3JpcHRzL1BvcHVwRGVsZXRlSW1hZ2UuanMnO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSAnLi9zY3JpcHRzL1BvcHVwV2l0aEltYWdlLmpzJztcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSAnLi9zY3JpcHRzL1NlY3Rpb24uanMnO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSAnLi9zY3JpcHRzL1VzZXJJbmZvLmpzJztcclxuaW1wb3J0IEFwaSBmcm9tICcuL3NjcmlwdHMvQXBpLmpzJztcclxuXHJcbmV4cG9ydCBjb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiAnaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS93ZWJfZXNfY29ob3J0XzA0JyxcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiAnYzM2MzE5NTQtODAzMS00YTFmLWIxYmItMTMxNWJkNzYzZmM4JyxcclxuICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgfSxcclxufSk7XHJcblxyXG5jb25zdCBwcm9maWxlUG9wdXBWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtRWRpdCwgc2VsZWN0b3JzKTtcclxuY29uc3QgaW1hZ2VQb3B1cFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGZvcm1JbWFnZSwgc2VsZWN0b3JzKTtcclxuY29uc3QgcHJvZmlsZUltYWdlUG9wdXBWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihmb3JtUHJvZmlsZUltYWdlLCBzZWxlY3RvcnMpO1xyXG5cclxucHJvZmlsZVBvcHVwVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuaW1hZ2VQb3B1cFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbnByb2ZpbGVJbWFnZVBvcHVwVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cF9wcmV2aWV3X2ltYWdlJyk7XHJcbnByZXZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuY29uc3QgZWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6ICcucG9wdXBfZWRpdF9wcm9maWxlJyxcclxuICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSkgPT4ge1xyXG4gICAgYXBpXHJcbiAgICAgIC5zZXRVc2VySW5mbyh7bmFtZTogZGF0YS5uYW1lLCBhYm91dDogZGF0YS5hYm91dH0pXHJcbiAgICAgIC50aGVuKChyZXNwb25zZSkgPT4ge1xyXG4gICAgICAgIHByb2ZpbGVVc2VyLnNldFVzZXJJbmZvKHt1c2VybmFtZTogcmVzcG9uc2UubmFtZSwgdXNlcm9jdXBhdGlvbjogcmVzcG9uc2UuYWJvdXR9KTtcclxuXHJcbiAgICAgICAgZWRpdFBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9LFxyXG4gIHN1Ym1pdEJ1dHRvbjogZWRpdFByb2ZpbGVTdWJtaXRCdXR0b24sXHJcbn0pO1xyXG5cclxuZWRpdFBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5leHBvcnQgY29uc3QgcHJvZmlsZVVzZXIgPSBuZXcgVXNlckluZm8oe1xyXG4gIHVzZXJOYW1lOiBwcm9maWxlVGl0bGUsXHJcbiAgdXNlck9jdXBhdGlvbjogcHJvZmlsZVByb2Zlc3Npb24sXHJcbiAgdXNlckF2YXRhcjogcHJvZmlsZUltYWdlLFxyXG59KTtcclxuXHJcbm9wZW5Gb3JtUHJvZmlsZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICBlZGl0UG9wdXAub3BlbigpO1xyXG4gIHByb2ZpbGVQb3B1cFZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5hcGlcclxuICAuZ2V0VXNlckluZm8oKVxyXG4gIC50aGVuKChyZXMpID0+IHtcclxuICAgIHByb2ZpbGVVc2VyLnNldFVzZXJJbmZvKHt1c2VybmFtZTogcmVzLm5hbWUsIHVzZXJvY3VwYXRpb246IHJlcy5hYm91dH0pO1xyXG4gICAgcHJvZmlsZVVzZXIuc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcclxuICAgIHByb2ZpbGVVc2VyLnVzZXJJZCA9IHJlcy5faWQ7XHJcbiAgfSlcclxuICAudGhlbigoKSA9PiB7XHJcbiAgICBhcGlcclxuICAgICAgLmdldENhcmRMaXN0KClcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgICAgICB7XHJcbiAgICAgICAgICAgIGl0ZW1zOiByZXMsXHJcbiAgICAgICAgICAgIHJlbmRlcmVyOiAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgICAgICAgICBjYXJkU2VjdGlvbi5hZGRDYXJkcyhjYXJkRWxlbWVudCk7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgICAgJy5jYXJkc19fY29udGFpbmVyJ1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgY2FyZFNlY3Rpb24ucmVuZGVyZXIoKTtcclxuXHJcbiAgICAgICAgY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gICAgICAgICAgcG9wdXBTZWxlY3RvcjogJy5wb3B1cF9hZGRfY2FyZCcsXHJcbiAgICAgICAgICBoYW5kbGVGb3JtU3VibWl0OiAoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICBhcGlcclxuICAgICAgICAgICAgICAuYWRkQ2FyZCh7bmFtZTogZGF0YS50aXRsZSwgbGluazogZGF0YVsnaW1hZ2UtbGluayddfSlcclxuICAgICAgICAgICAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbmV3Q2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgY2FyZFNlY3Rpb24uYWRkSXRlbShuZXdDYXJkRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgICBzdWJtaXRCdXR0b246IGFkZENhcmRTdWJtaXRCdXR0b24sXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIGFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgICAgICBvcGVuQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcclxuICAgICAgICAgIGFkZENhcmRQb3B1cC5vcGVuKCk7XHJcbiAgICAgICAgICBpbWFnZVBvcHVwVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcblxyXG5jb25zdCBwcm9maWxlSW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiAnLnBvcHVwX2ltYWdlX3Byb2ZpbGUnLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IChkYXRhKSA9PiB7XHJcbiAgICBjb25zdCBhdmF0YXIgPSBkYXRhWydpbWFnZS1saW5rJ107XHJcbiAgICBhcGlcclxuICAgICAgLnNldFVzZXJBdmF0YXIoYXZhdGFyKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgcHJvZmlsZVVzZXIuc2V0VXNlckF2YXRhcihhdmF0YXIpO1xyXG4gICAgICAgIHByb2ZpbGVJbWFnZVBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9LFxyXG4gIHN1Ym1pdEJ1dHRvbjogcHJvZmlsZUltYWdlU3VibWl0QnV0dG9uLFxyXG59KTtcclxuXHJcbnByb2ZpbGVJbWFnZVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5wcm9maWxlSW1hZ2VPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xyXG4gIHByb2ZpbGVJbWFnZVBvcHVwLm9wZW4oKTtcclxuICBwcm9maWxlSW1hZ2VQb3B1cFZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5leHBvcnQgY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwRGVsZXRlSW1hZ2Uoe1xyXG4gIHBvcHVwU2VsZWN0b3I6ICcucG9wdXBfZGVsZXRlX2NhcmQnLFxyXG4gIHN1Ym1pdEJ1dHRvbjogZGVsZXRlQ2FyZFN1Ym1pdEJ1dHRvbixcclxufSk7XHJcblxyXG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUNhcmQoZGF0YSkge1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcclxuICAgIHtcclxuICAgICAgZGF0YSxcclxuICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoe25hbWUsIGxpbmt9KSA9PiB7XHJcbiAgICAgICAgcHJldmlld1BvcHVwLm9wZW4oe25hbWUsIGxpbmt9KTtcclxuICAgICAgfSxcclxuICAgICAgaGFuZGxlRGVsZXRlQ2xpY2s6ICh7aWR9KSA9PiB7XHJcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oKTtcclxuICAgICAgICBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICAgIGFwaVxyXG4gICAgICAgICAgICAucmVtb3ZlQ2FyZChpZClcclxuICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICAgICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICAgICAgICAgIG5ld0NhcmQuX2RlbGV0ZUJ1dHRvbigpO1xyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICAgIGhhbmRsZUxpa2VBZGQ6ICh7aWR9KSA9PiB7XHJcbiAgICAgICAgYXBpXHJcbiAgICAgICAgICAuYWRkTGlrZShpZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgbmV3Q2FyZC51cGRhdGVMaWtlcyhyZXMubGlrZXMpO1xyXG4gICAgICAgICAgICBuZXdDYXJkLmFkZEhlYXJ0KCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG4gICAgICB9LFxyXG4gICAgICBoYW5kbGVMaWtlRGVsZXRlOiAoe2lkfSkgPT4ge1xyXG4gICAgICAgIGFwaVxyXG4gICAgICAgICAgLnJlbW92ZUxpa2UoaWQpXHJcbiAgICAgICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICAgIG5ld0NhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzKTtcclxuICAgICAgICAgICAgbmV3Q2FyZC5yZW1vdmVIZWFydCgpO1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICAgICAgfSxcclxuICAgICAgdXNlcklkOiBwcm9maWxlVXNlci51c2VySWQsXHJcbiAgICB9LFxyXG4gICAgJy5jYXJkLXRlbXBsYXRlJ1xyXG4gICk7XHJcbiAgcmV0dXJuIG5ld0NhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbn1cclxuXHJcbi8vIGNvbnN0IGNhcmRTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbi8vICAge1xyXG4vLyAgICAgaXRlbXM6IFtdLFxyXG4vLyAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbi8vICAgICAgIGNvbnN0IG5ld0NhcmQgPSBuZXcgQ2FyZChcclxuLy8gICAgICAgICB7XHJcbi8vICAgICAgICAgICBkYXRhLFxyXG4vLyAgICAgICAgICAgaGFuZGxlQ2FyZENsaWNrOiAoe25hbWUsIGxpbmt9KSA9PiB7XHJcbi8vICAgICAgICAgICAgIHByZXZpZXdQb3B1cC5vcGVuKHtuYW1lLCBsaW5rfSk7XHJcbi8vICAgICAgICAgICB9LFxyXG4vLyAgICAgICAgICAgY2FsbGJhY2tzOiB7XHJcbi8vICAgICAgICAgICAgIGRlbGV0ZUhhbmRsZXIoKSB7XHJcbi8vICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5kZWxldGVDYXJkKGRhdGEuX2lkKTtcclxuLy8gICAgICAgICAgICAgfSxcclxuLy8gICAgICAgICAgICAgbGlrZXNIYW5kbGVyKCkge1xyXG4vLyAgICAgICAgICAgICAgIHJldHVybiB7YWRkTGlrZTogYXBpLmFkZExpa2UoZGF0YS5faWQpLCByZW1vdmVMaWtlOiBhcGkucmVtb3ZlTGlrZShkYXRhLl9pZCl9O1xyXG4vLyAgICAgICAgICAgICB9LFxyXG4vLyAgICAgICAgICAgfSxcclxuLy8gICAgICAgICAgIHVzZXI6IHVzZXJJbmZvLFxyXG4vLyAgICAgICAgIH0sXHJcbi8vICAgICAgICAgJy5jYXJkLXRlbXBsYXRlJ1xyXG4vLyAgICAgICApO1xyXG4vLyAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IG5ld0NhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbi8vICAgICAgIGNhcmRTZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xyXG4vLyAgICAgfSxcclxuLy8gICB9LFxyXG4vLyAgICcuY2FyZHNfX2NvbnRhaW5lcidcclxuLy8gKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7YmFzZVVybCwgaGVhZGVyc30pIHtcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgfVxyXG5cclxuICAvLyBfcmV0dXJuUmVzIGVzIHVuYSBmdW5jacOzbiDDunRpbCBwYXJhIG1hbmVqYXIgZXJyb3JlcyB5IHByb2Nlc2FyIGxvcyBkYXRvcyByZWNpYmlkb3MgZGUgbGFzIHNvbGljaXR1ZGVzIGRlIEFQSVxyXG4gIF9yZXR1cm5SZXMocmVzKSB7XHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy9nZXRDYXJkTGlzdCBoYXJhIHVuYSBwZXRpY2nDs24gcGFyYSBvYnRlbmVyIGxhcyB0YXJqZXRhcyBpbmljaWFsZXNcclxuICBnZXRDYXJkTGlzdCgpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy9jYXJkcycsIHtcclxuICAgICAgbWV0aG9kOiAnR0VUJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fcmV0dXJuUmVzKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vZ2V0VXNlckluZm8gaGFyYSB1bmEgcGV0aWNpw7NuIHBhcmEgb2J0ZW5lciBsb3MgZGF0b3MgZGVsIHVzdWFyaW8gYWN0dWFsXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlcnMvbWUnLCB7XHJcbiAgICAgIG1ldGhvZDogJ0dFVCcsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX3JldHVyblJlcyhyZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvL3NldFVzZXJJbmZvIGhhcmEgdW5hIHBldGljacOzbiBQQVRDSCBhbCBlbmRwb2ludCBwYXJhIGFjdHVhbGl6YXIgbG9zIGRhdG9zIGRlbCB1c3VhcmlvIGFjdHVhbCBjb24gZWwgbm9tYnJlIHkgZGVzY3JpcGNpw7NuIGVzcGVjaWZpY2Fkb3MuXHJcbiAgc2V0VXNlckluZm8oe25hbWUsIGFib3V0fSkge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgZmV0Y2godGhpcy5fYmFzZVVybCArICcvdXNlcnMvbWUnLCB7XHJcbiAgICAgICAgbWV0aG9kOiAnUEFUQ0gnLFxyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgbmFtZSxcclxuICAgICAgICAgIGFib3V0LFxyXG4gICAgICAgIH0pLFxyXG4gICAgICB9KVxyXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLl9yZXR1cm5SZXMocmVzKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC8vYm9ycmFyIGVzdGUgY2F0Y2ggbHVlZ28geGRcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICAvL2FkZENhcmQgaGFyYSB1bmEgcGV0aWNpw7NuIFBPU1QgYWwgZW5kcG9pbnQgcGFyYSBjcmVhciB1bmEgbnVldmEgdGFyamV0YSBjb24gZWwgbm9tYnJlIHkgbGluayBlc3BlY2lmaWNhZG9zLlxyXG4gIGFkZENhcmQoe25hbWUsIGxpbmt9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMnLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fcmV0dXJuUmVzKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vcmVtb3ZlQ2FyZCBoYXJhIHVuYSBwZXRpY2nDs24gREVMRVRFIGFsIGVuZHBvaW50IHBhcmEgZWxpbWluYXIgbGEgdGFyamV0YSBjb24gZWwgaWQgZXNwZWNpZmljYWRvLlxyXG4gIHJlbW92ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvJyArIGNhcmRJZCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9yZXR1cm5SZXMocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy9zZXRVc2VyQXZhdGFyIGhhcmEgdW5hIHBldGljacOzbiBQQVRDSCBhbCBlbmRwb2ludCBwYXJhIGFjdHVhbGl6YXIgZWwgYXZhdGFyIGRlbCB1c3VhcmlvIGFjdHVhbCBjb24gZWwgbGluayBlc3BlY2lmaWNhZG8uXHJcbiAgc2V0VXNlckF2YXRhcihhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaCh0aGlzLl9iYXNlVXJsICsgJy91c2Vycy9tZS9hdmF0YXInLCB7XHJcbiAgICAgIG1ldGhvZDogJ1BBVENIJyxcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIGF2YXRhcjogYXZhdGFyLFxyXG4gICAgICB9KSxcclxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5fcmV0dXJuUmVzKHJlcyk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8vYWRkTGlrZSBoYXJhIHVuYSBwZXRpY2nDs24gUFVUIGFsIGVuZHBvaW50IHBhcmEgYWdyZWdhciB1biBsaWtlIGEgbGEgdGFyamV0YSBjb24gZWwgaWQgZXNwZWNpZmljYWRvLlxyXG4gIGFkZExpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvbGlrZXMvJyArIGNhcmRJZCwge1xyXG4gICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9yZXR1cm5SZXMocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLy9yZW1vdmVMaWtlIGhhcmEgdW5hIHBldGljacOzbiBERUxFVEUgYWwgZW5kcG9pbnQgcGFyYSBlbGltaW5hciBlbCBsaWtlIGEgbGEgdGFyamV0YSBjb24gZWwgaWQgZXNwZWNpZmljYWRvLlxyXG4gIHJlbW92ZUxpa2UoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2godGhpcy5fYmFzZVVybCArICcvY2FyZHMvbGlrZXMvJyArIGNhcmRJZCwge1xyXG4gICAgICBtZXRob2Q6ICdERUxFVEUnLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9yZXR1cm5SZXMocmVzKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsib3BlbkZvcm1Qcm9maWxlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib3BlbkNhcmRCdXR0b24iLCJmb3JtRWRpdCIsImZvcm1JbWFnZSIsImZvcm1Qcm9maWxlSW1hZ2UiLCJwcm9maWxlVGl0bGUiLCJwcm9maWxlUHJvZmVzc2lvbiIsInByb2ZpbGVJbWFnZSIsImRlbGV0ZUNhcmRTdWJtaXRCdXR0b24iLCJlZGl0UHJvZmlsZVN1Ym1pdEJ1dHRvbiIsInByb2ZpbGVJbWFnZVN1Ym1pdEJ1dHRvbiIsInByb2ZpbGVJbWFnZU92ZXJsYXkiLCJhZGRDYXJkU3VibWl0QnV0dG9uIiwic2VsZWN0b3JzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJDYXJkIiwidGVtcGxhdGUiLCJkYXRhIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQWRkIiwiaGFuZGxlTGlrZURlbGV0ZSIsInVzZXJJZCIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfdGVtcGxhdGUiLCJfaWQiLCJfbGlrZXNDb3VudCIsImxpa2VzIiwibGVuZ3RoIiwiX293bmVySWQiLCJvd25lciIsIl91c2VyIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQWRkIiwiX2hhbmRsZUxpa2VEZWxldGUiLCJfbGlrZXNBcnJheSIsIl9jYXJkTGlrZXMiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiaGVhcnRCdXR0b24iLCJfZWxlbWVudCIsImhlYXJ0TnVtYmVyIiwiY2xhc3NMaXN0IiwiYWRkIiwidGV4dENvbnRlbnQiLCJyZW1vdmUiLCJjbG9zZXN0IiwicmVzQXJyYXkiLCJhZGRFdmVudExpc3RlbmVyIiwic29tZSIsImxpa2UiLCJpZCIsIl9nZXRUZW1wbGF0ZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImNhcmRJbWFnZSIsInNyYyIsInNldEF0dHJpYnV0ZSIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsIl9pbnB1dExpc3QiLCJmb3JFYWNoIiwiaW5wdXQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2Zvcm1FbGVtZW50IiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9idXR0b25FbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0IiwiX2hhc0ludmFsaWRJbnB1dCIsImRpc2FibGVkIiwidmFsdWUiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJjbG9zZSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdWJtaXRCdXR0b24iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9zdWJtaXRCdXR0b24iLCJyZW5kZXJMb2FkaW5nIiwicmVzZXQiLCJfZm9ybVZhbHVlcyIsImlzTG9hZGluZyIsImRhdGFzZXQiLCJ0ZXh0Y29udGVudCIsIl9nZXRJbnB1dFZhbHVlcyIsIlBvcHVwRGVsZXRlSW1hZ2UiLCJhY3Rpb24iLCJQb3B1cFdpdGhJbWFnZSIsIl9pbWFnZSIsIl90aXRsZSIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJhcHBlbmQiLCJVc2VySW5mbyIsInVzZXJOYW1lIiwidXNlck9jdXBhdGlvbiIsInVzZXJBdmF0YXIiLCJfdXNlck5hbWUiLCJfdXNlck9jdXBhdGlvbiIsIl91c2VySWQiLCJfdXNlckF2YXRhciIsInVzZXJuYW1lIiwidXNlcm9jdXBhdGlvbiIsImF2YXRhciIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaCIsIm1ldGhvZCIsInRoZW4iLCJfcmV0dXJuUmVzIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsImNhcmRJZCIsImF1dGhvcml6YXRpb24iLCJwcm9maWxlUG9wdXBWYWxpZGF0b3IiLCJpbWFnZVBvcHVwVmFsaWRhdG9yIiwicHJvZmlsZUltYWdlUG9wdXBWYWxpZGF0b3IiLCJlbmFibGVWYWxpZGF0aW9uIiwicHJldmlld1BvcHVwIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlZGl0UG9wdXAiLCJzZXRVc2VySW5mbyIsInJlc3BvbnNlIiwicHJvZmlsZVVzZXIiLCJvcGVuIiwicmVzZXRWYWxpZGF0aW9uIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VyQXZhdGFyIiwiZ2V0Q2FyZExpc3QiLCJjYXJkU2VjdGlvbiIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsImFkZENhcmRzIiwiYWRkQ2FyZFBvcHVwIiwiYWRkQ2FyZCIsInRpdGxlIiwibmV3Q2FyZEVsZW1lbnQiLCJhZGRJdGVtIiwicHJvZmlsZUltYWdlUG9wdXAiLCJkZWxldGVDYXJkUG9wdXAiLCJuZXdDYXJkIiwic2V0U3VibWl0QWN0aW9uIiwicmVtb3ZlQ2FyZCIsIl9kZWxldGVCdXR0b24iLCJhZGRMaWtlIiwidXBkYXRlTGlrZXMiLCJhZGRIZWFydCIsInJlbW92ZUxpa2UiLCJyZW1vdmVIZWFydCIsImdlbmVyYXRlQ2FyZCJdLCJzb3VyY2VSb290IjoiIn0=